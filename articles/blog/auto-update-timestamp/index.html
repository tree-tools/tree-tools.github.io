<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>リストの編集をしたら自動で更新日時を書き込んでくれるツール | GASで作業をもっとラクに</title>
  <meta name="description" content="スプレッドシートの編集に合わせて、GASで自動的に更新日時を記録するツールを紹介。入力忘れを防ぐ簡単な自動化の実践例です。" />
  <meta property="og:title" content="GASでスプレッドシートの更新日時を自動記録するツール" />
  <meta property="og:description" content="スプレッドシートの1列目を編集したら、2列目に自動で日時を記録するGASの実用例を紹介。" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://tree-tools-gas-guide.pages.dev/articles/blog/auto-update-timestamp/" />
  <meta property="og:image" content="https://tree-tools-gas-guide.pages.dev/assets/images/tree-toos-icon.png">

  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="canonical" href="https://tree-tools-gas-guide.pages.dev/articles/blog/auto-update-timestamp/" />

  <!-- 共通JS -->
  <script src="/assets/js/includes.js"></script>
  <script src="/assets/js/common.js"></script>
  <!-- Prism.js コード用 -->
  <script src="/assets/js/copy-code.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-tomorrow.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-javascript.min.js"></script>
  <!-- favicon -->
  <link rel="icon" href="https://tree-tools-gas-guide.pages.dev/assets/images/tree-toos-icon.png" type="image/x-icon">

</head>

<body>
  <!-- ヘッダー読込 -->
  <div data-include="/includes/header.html"></div>

  <main>
    <nav class="breadcrumb" aria-label="パンくずリスト">
      <ol>
        <li><a href="/">トップ</a></li>
        <li><a href="/articles/blog/">記事一覧</a></li>
        <li>記事</li>
      </ol>
    </nav>

    <article class="article-content">

      <h1 class="page-title">リストの編集をしたら自動で更新日時を書き込んでくれるツール</h1>

      <div class="article-meta">
        <span class="date">投稿日：2025-07-16</span> |
        <span class="category">カテゴリ：技術</span> |
        <span class="tags">
          <span>GAS</span>
          <span>ツール</span>
          <span>業務効率化</span>
        </span>
      </div>

      <!-- 広告：タグ直後 -->
      <div class="ad-top">
        <!-- admax -->
        <script src="https://adm.shinobi.jp/o/c076ac9032ddef7041a7cdb278971965"></script>
        <!-- admax -->
      </div>

      <section class="section summary">
        <p>
          スプレッドシートの1列目を編集した際に、同じ行の2列目へ現在の日時を自動入力するGASスクリプトの紹介です。<br>
          手動での記録漏れを防ぎたい方におすすめです。
        </p>
        <p>
          このブログは、Google Apps Script（GAS）を使った自作ツールの記録や、開発の過程での気づきをまとめたものです。<br>
          丁寧な解説というより、<strong>「こんなこともGASでできるんだ」</strong>というアイディアのきっかけになれば幸いです。
        </p>
      </section>

      <nav class="section toc">
        <h2>目次</h2>
        <ul>
          <li><a href="#purpose">やりたかったこと</a></li>
          <li><a href="#logic">使ったロジック・ポイント</a></li>
          <li><a href="#code">コード例</a></li>
          <li><a href="#memo">メモ・反省・次回やりたいこと</a></li>
          <li><a href="#links">関連リンク</a></li>
        </ul>
      </nav>

      <!-- admax -->
      <div class="ad-content">
        <script src="https://adm.shinobi.jp/o/98662ea3644e9850702d9a74c27b535b"></script>
      </div>
      <!-- admax -->

      <section id="purpose" class="section">
        <h2>やりたかったこと</h2>
        <p>
          業務で使うスプレッドシートで、「いつ更新したか」を毎回記録していました。<br>
          最初はショートカットで日時を入力していましたが、たまに忘れてしまい困っていました。<br>
          そこで「編集したら自動で日時を入れてくれるようにしたい」と思い、このツールを作りました。
        </p>
      </section>

      <section id="logic" class="section">
        <h2>使ったロジック・ポイント</h2>
        <p>
          今回の更新日時記録ツールでは、GASのイベントトリガーを使って以下のような処理を行っています。
        </p>

        <h3>① 編集されたセルの情報を取得</h3>
        <ul class="list-area">
          <li><code>onEdit(e)</code> イベントで編集操作を検知</li>
          <li><code>e.range</code> から行・列の位置を取得</li>
          <li>対象となる列・行かどうかをチェック</li>
        </ul>

        <h3>② 処理対象シートを制限</h3>
        <ul class="list-area">
          <li>特定のシート名だけ処理対象にする</li>
          <li>別シートで反応しないようガード</li>
        </ul>

        <h3>③ 日時を書き込む</h3>
        <ul class="list-area">
          <li><code>new Date()</code> で現在日時を取得</li>
          <li>同じ行の2列目に日時を記録</li>
        </ul>
      </section>

      <!-- admax -->
      <div class="ad-content">
        <script src="https://adm.shinobi.jp/o/98662ea3644e9850702d9a74c27b535b"></script>
      </div>
      <!-- admax -->

      <section id="code" class="section">
        <h2>コード例</h2>
        <p>以下のコードをスプレッドシートのスクリプトエディタに貼り付ければ、すぐに使えます。</p>

        <div class="code-container">
          <button class="copy-btn">Copy</button>
          <pre><code class="language-javascript">// リストシートで1列目が編集されたら、2列目に現在日時を記録
function onEdit(e) {
  const sheetName = 'リスト'; // 対象のシート名
  const range = e.range;
  const sheet = range.getSheet();

  if (sheet.getName() !== sheetName) return;

  const row = range.getRow();
  const col = range.getColumn();

  if (col === 1 && row >= 3) {
    const date = new Date();
    sheet.getRange(row, 2).setValue(date);
  }
}</code></pre>
        </div>
      </section>

      <section id="memo" class="section">
        <h2>メモ・反省・次回やりたいこと</h2>
        <p>
          - 条件判定が甘いと意図しないセルにも反応してしまうので注意が必要でした。<br>
          - シート名でフィルタをかけないと、他のシートでも動いてしまうので必ずチェックするようにしています。<br>
          - 次は「誰が編集したのか」など、履歴ログを別シートに残す仕組みを作ってみたいです。
        </p>
      </section>

      <p class="back-link">
        <a href="/articles/blog/index.html">← 記事一覧に戻る</a>
      </p>

      <section class="section">
        <p>
          <a href="/">トップページへ戻る</a>
        </p>
      </section>

      <!-- 📍広告：フッター直前 -->
      <div class="ad-bottom">
        <!-- admax -->
        <script src="https://adm.shinobi.jp/o/c076ac9032ddef7041a7cdb278971965"></script>
        <!-- admax -->
      </div>


    </article>
  </main>

  <!-- フッター読み込み -->
  <div data-include="/includes/footer.html"></div>

</body>

</html>
<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ボタンを押したら指定の箇所だけクリアにするGASツール | GASで作業をもっとラクに</title>
  <meta name="description"
    content="Googleスプレッドシートで、ボタン一つで特定範囲だけをクリアするGAS関数を紹介。誤操作を防ぐ確認ダイアログ付きで、現場で使えるスクリプトと注意点を解説します。" />
  <meta property="og:title" content="GASで指定範囲だけをクリアするボタン関数" />
  <meta property="og:description" content="スプレッドシートで毎回同じ範囲をクリアする作業を自動化。GASを使って安心・安全に使える関数を紹介します。" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://tree-tools.github.io/articles/blog/gas-mobile-trigger/index.html" />
  <!-- <meta property="og:image" content="https://example.com/assets/img/ogp-clear-range.png" /> -->

  <!-- 広告コードはここに挿入 -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6247585947417000"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="/assets/css/style.css">
  <link href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-tomorrow.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-javascript.min.js"></script>
  <script src="/assets/js/copy-code.js"></script>
</head>

<body>
  <!-- ヘッダー読込 -->
  <div data-include="/includes/header.html"></div>

  <main>
    <nav class="breadcrumb" aria-label="パンくずリスト">
      <ol>
        <li><a href="/">トップ</a></li>
        <li><a href="/articles/blog/">記事一覧</a></li>
        <li>記事</li>
      </ol>
    </nav>

    <article class="article-content">

      <h1 class="page-title">ボタンを押したら指定の箇所だけクリアにするGASツール</h1>

      <div class="article-meta">
        <span class="date">投稿日：2025-07-16</span> |
        <span class="category">カテゴリ：技術</span> |
        <span class="tags">
          <span>GAS</span>
          <span>ツール</span>
          <span>業務効率化</span>
          <span>スプレッドシート</span>
        </span>
      </div>

      <section class="section summary">
        <p>Googleスプレッドシートで、毎回同じ箇所だけをクリアしたい…そんな作業を効率化するためのGASスクリプトを作成。消す前に確認ダイアログも出る安心仕様で、他の人にも使ってもらいやすくなりました。</p>
      </section>

      <section class="section intro">
        <p>
          このブログは、Google Apps Script（GAS）を使った自作ツールの記録や、開発の過程での気づきをまとめたものです。<br>
          丁寧な解説というより、<strong>「こんなこともGASでできるんだ」</strong>というアイディアのきっかけになれば幸いです。
        </p>
      </section>

      <!-- body内に広告表示位置 -->
      <!-- 横長ノーマル -->
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6247585947417000" data-ad-slot="9719436679"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      <nav class="section toc">
        <h2>目次</h2>
        <ul>
          <li><a href="#purpose">やりたかったこと</a></li>
          <li><a href="#logic">使ったロジック・ポイント</a></li>
          <li><a href="#code">コード例</a></li>
          <li><a href="#memo">メモ・反省・次回やりたいこと</a></li>
          <li><a href="#links">関連リンク</a></li>
        </ul>
      </nav>

      <section id="purpose" class="section">
        <h2>やりたかったこと</h2>
        <p>
          スプレッドシートで特定の範囲だけをクリアしたいが、範囲指定を間違えることがあり、必要な部分まで消してしまうことがあった。<br>
          自分は把握していても、他の人が操作するとミスが起きがちなので、誰でも安全に操作できるように「指定範囲だけクリアするボタン＋確認メッセージ付き関数」を作成した。
        </p>
      </section>

      <section id="logic" class="section">
        <h2>使ったロジック・ポイント</h2>
        <p>
          今回のクリア機能では、GASの基本的な操作を組み合わせて、特定範囲のデータだけを消去できるようにしています。
        </p>

        <h3>① アクティブシートの取得</h3>
        <ul>
          <li>どのシートが開かれているかを自動的に取得</li>
          <li>ユーザーが何かを選ばなくても実行可能</li>
          <li>汎用性が高い</li>
        </ul>

        <h3>② 指定範囲の取得とクリア</h3>
        <ul>
          <li>範囲は "B3:D20" など固定値で指定</li>
          <li>`.clearContent()` を使って値だけクリア</li>
          <li>背景色や罫線などはそのまま残す</li>
        </ul>

        <h3>③ 処理前の確認ダイアログ</h3>
        <ul>
          <li>`Browser.msgBox()` を使ってユーザーに確認を取る</li>
          <li>うっかりミスを防止</li>
          <li>キャンセル時は何も処理しない</li>
        </ul>
      </section>

      <!-- body内に広告表示位置 -->
      <!-- 横長ノーマル -->
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6247585947417000" data-ad-slot="9719436679"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      <section id="code" class="section">
        <h2>コード例</h2>
        <p>この関数を使えば、ボタンを押すだけで指定範囲のみを安全にクリアできます。確認メッセージ付きで、誤操作も防げます。</p>

        <div class="code-container">
          <button class="copy-btn">Copy</button>
          <pre><code class="language-javascript">// 指定範囲を確認メッセージ付きでクリア
function clearTargetRange() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const range = sheet.getRange("B3:D20"); // 対象範囲を指定

  const result = Browser.msgBox(
    "確認",
    "B3:D20 をクリアしてもよろしいですか？",
    Browser.Buttons.OK_CANCEL
  );

  if (result === "ok") {
    range.clearContent(); // 値だけ消す。書式はそのまま
  } else {
    Logger.log("キャンセルされました");
  }
}</code></pre>
        </div>
      </section>

      <section id="memo" class="section">
        <h2>メモ・反省・次回やりたいこと</h2>
        <p>
          消しちゃいけないところを間違ってクリアする事故がほぼゼロになりました。<br>
          チェックボックスと連動して「チェックがついてる行だけ消す」などの発展も考えたいです。<br>
          他の作業者による行や列の挿入・削除で範囲がズレないよう、名前付き範囲の活用も今後検討したいです。
        </p>
      </section>

      <section id="links" class="section">
        <h2>関連リンク</h2>
        <ul>
          <li><a href="/articles/blog/ec-csv-to-spreadsheet/">【GASで簡単自動化】ECサイトのCSVをスプレッドシートに自動転記するGASツール</a></li>
        </ul>
      </section>

      <p class="back-link">
        <a href="/articles/blog/index.html">← 記事一覧に戻る</a>
      </p>

      <!-- body内に広告表示位置 -->
      <!-- 横長ノーマル -->
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6247585947417000" data-ad-slot="9719436679"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      <section class="section">
        <p>
          <a href="/">トップページへ戻る</a>
        </p>
      </section>

    </article>
  </main>

  <!-- フッター読み込み -->
  <div data-include="/includes/footer.html"></div>

  <script src="/assets/js/includes.js"></script>
  <script src="/assets/js/common.js"></script>

</body>

</html>
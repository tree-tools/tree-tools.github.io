<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>forって何？GAS初心者が実例で学んだ繰り返し処理の基本 | GASで作業をもっとラクに</title>
  <meta name="description" content="GAS初心者がつまずきやすいfor文について、基本構文・スプレッドシート活用例・ifとの組み合わせ・多重ループの注意点まで、独学体験をもとに実践的に解説します。" />

  <meta property="og:title" content="forって何？ | GASで作業をもっとラクに" />
  <meta property="og:description" content="GAS初心者向けにfor文の基本・活用例・注意点を実体験ベースで解説。スプレッドシート操作や多重ループにも触れています。" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://tree-tools-gas-guide.pages.dev/articles/blog/gas-for-loop/" />
  <meta property="og:image" content="https://tree-tools-gas-guide.pages.dev/assets/images/tree-toos-icon.png" />

  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="canonical" href="https://tree-tools-gas-guide.pages.dev/articles/blog/gas-for-loop" />

  <!-- 共通JS -->
  <script src="/assets/js/includes.js"></script>
  <script src="/assets/js/common.js"></script>
  <!-- Prism.js コード用 -->
  <script src="/assets/js/copy-code.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-tomorrow.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-javascript.min.js"></script>
  <!-- favicon -->
  <link rel="icon" href="https://tree-tools-gas-guide.pages.dev/assets/images/tree-toos-icon.png" type="image/x-icon">
  <!-- 広告 -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6247585947417000"
    crossorigin="anonymous"></script>
</head>

<body>
  <div data-include="/includes/header.html"></div>

  <main>
    <nav class="breadcrumb" aria-label="パンくずリスト">
      <ol>
        <li><a href="/">トップ</a></li>
        <li><a href="/articles/blog/">記事一覧</a></li>
        <li>記事</li>
      </ol>
    </nav>

    <article class="article-content">

      <h1 class="page-title">forって何？GAS初心者が実例で学んだ繰り返し処理の基本</h1>

      <div class="article-meta">
        <span class="date">投稿日：2025-07-23</span> |
        <span class="category">カテゴリ：技術</span> |
        <span class="tags">
          <span>GAS</span>
          <span>業務効率化</span>
          <span>How to</span>
          <span>GAS実践入門</span>
        </span>
      </div>

      <section class="section summary">
        <p>
          GAS初心者の頃に最初につまずいた「for文」について、自分の実体験を元に解説します。基本構文からスプレッドシートでの実用例、ifとの組み合わせ、二重ループやインデントの工夫まで、「実際にどう使ったか」をベースに紹介します。
        </p>
        <p>
          このブログは、Google Apps Script（GAS）を使った自作ツールの記録や、開発の過程での気づきをまとめたものです。<br>
          丁寧な解説というより、<strong>「こんなこともGASでできるんだ」</strong>というアイディアのきっかけになれば幸いです。
        </p>
      </section>

      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6247585947417000" data-ad-slot="9719436679"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

      <nav class="section toc">
        <h2>目次</h2>
        <ul>
          <li><a href="#basic">for文の基本</a></li>
          <li><a href="#spreadsheet">スプレッドシートでの実用例</a></li>
          <li><a href="#if-combo">ifとの組み合わせ</a></li>
          <li><a href="#double-loop">二重ループの注意点</a></li>
          <li><a href="#advanced">三重以上とreturn・continueの活用</a></li>
          <li><a href="#indent">インデントの意味とコツ</a></li>
          <li><a href="#summary">まとめ</a></li>
        </ul>
      </nav>

      <section id="basic" class="section">
        <h2>for文の基本</h2>
        <p>繰り返し処理の基本形は以下のような形です。</p>
        <pre><code class="language-javascript">for (let i = 0; i < 5; i++) {
  Logger.log(i);
}</code></pre>
        <p>
          「何回も同じ処理をしたい」場面でまず使うのがこの形です。<br>
          iが0から始まって、1ずつ増えながら、5未満の間繰り返す、という流れです。
        </p>
        <p>初心者の頃は、</p>
        <ul>
          <li>letって必要？</li>
          <li>i < 5 で終わるの？</li>
          <li>i++ ってなんだ？</li>
        </ul>
        <p>みたいなところが気になりましたが、まずは「何回も同じ処理をしたいときに使うんだ」とだけ覚えればOKです。</p>
        <p>この例文であれば「最初は0で、iは5未満で、1つずつ増えてる」って内容で繰り返し処理が行われています。</p>

      </section>

      <section id="spreadsheet" class="section">
        <h2>スプレッドシートでの実用例</h2>
        <p>GASでスプシを操作するなら、行ごとに何か処理したいときに for が活躍します。</p>
        <pre><code class="language-javascript">const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("データ");
const values = sheet.getDataRange().getValues();

for (let i = 1; i &lt; values.length; i++) {
  const row = values[i];
  Logger.log(row[0]);
}</code></pre>
        <p>
          ヘッダー行を飛ばして1行ずつ処理したいときにこのパターンをよく使います。<br>
          iは行数を表していて、1行ずつ順に処理をしています<br>
          values[i] で1行分の配列が取れます。
        </p>
      </section>

      <section id="if-combo" class="section">
        <h2>ifとの組み合わせ</h2>
        <p>
          for文でデータを1行ずつ取り出して処理するとき、特定の条件に合致するデータだけを対象にしたい場合があります。 そんなときに使うのが
          <code>if</code>文です。「この条件を満たしていたら実行する」という、分岐処理の基本構文です。
        </p>
        <p>
          たとえば、スプレッドシートのデータから「未処理」と記された行だけを抽出してログに表示したいとき、次のように記述します。
        </p>
        <pre><code class="language-javascript">for (let i = 1; i &lt; values.length; i++) {
  const row = values[i];
  if (row[3] === "未処理") {
    Logger.log("処理が必要：" + row[0]);
  }
}</code></pre>
        <p>
          このコードでは、スプレッドシートの2行目（インデックス1）以降のデータを順番に見ていき、各行の4列目（配列ではインデックス3）が「未処理」となっている場合に、1列目（インデックス0）の値をログに出力しています。
        </p>
        <p>
          「条件付きで処理を行いたい」という場面では、<code>if</code> 文は最も基本的かつ重要な構文の一つです。
          例えば、「特定の担当者の行だけ処理したい」「金額が1万円以上のデータだけ抽出したい」といったニーズにも、同様の書き方で対応できます。
        </p>
        <p>
          <code>if</code> を使うことで、すべての行に一律で処理をするのではなく、「必要なデータだけを選んで処理する」ことが可能になり、無駄な処理を避けられるだけでなく、バグやミスの防止にもつながります。
        </p>
        <p>
          条件分岐を使いこなすことは、GASに限らずプログラミング全般で非常に重要な考え方です。ぜひ繰り返し使って慣れておきましょう。
        </p>

      </section>

      <section id="double-loop" class="section">
        <h3>二重ループの注意点</h3>
        <pre><code class="language-javascript">for (let i = 0; i &lt; list1.length; i++) {
  for (let j = 0; j &lt; list2.length; j++) {
    if (list1[i][0] === list2[j][0]) {
      Logger.log("一致：" + list1[i][0]);
    }
  }
}</code></pre>
        <p> このコードは、2つのリスト（list1とlist2）を比較し、それぞれの1列目（[0]）が一致する要素をログに出力する処理です。
          「リストの中のリスト（2次元配列）」を扱うときや、「すべての組み合わせをチェックしたい」ときなどに、二重ループ（二重のfor文）を使うことがあります。 </p>
        <p> ただし、多重ループを使う場合は以下の点に注意が必要です。 </p>
        <ul>
          <li><strong>変数名（i/jなど）が意味を持つようにする：</strong>ネストが深くなるほど、何をループしているのか分かりづらくなります。可能であれば <code>outerIndex</code> や
            <code>innerIndex</code> のように、少し意味を持たせた変数名を使うと可読性が上がります。
          </li>
          <li><strong>処理の中身が複雑になりすぎないように：</strong>ネストが深いまま複雑な処理を追加すると、バグの原因になります。必要に応じて関数に分けるなど工夫しましょう。</li>
          <li><strong>パフォーマンスにも注意：</strong>2つの配列が大きい場合、処理回数が <code>list1.length × list2.length</code>
            になるため、動作が重くなることがあります。最適化やループ回避の工夫も重要です。</li>
        </ul>
        <p> 二重ループは便利ですが、構造が複雑になりやすいため、できるだけシンプルに保つことを意識しましょう。 </p>
      </section>

      <section id="advanced" class="section">
        <h2>三重以上とreturn・continueの活用</h2>
        <p>
          ループ処理が二重、三重と深くなるにつれて、コードの可読性はどんどん下がっていきます。<br>
          処理が複雑になると、どの条件でどこまで処理を続けるのか、何をスキップして何を実行するのかが分かりづらくなり、バグの原因にもなりがちです。
        </p>
        <p>
          そんなときに役立つのが、<strong><code>continue</code></strong> や
          <strong><code>return</code></strong>といった「処理の流れを制御する命令」です。<br>
          これらを上手に使うことで、ループの中でも<strong>必要な処理だけをシンプルに書く</strong>ことができ、ネストの深いコードでも見通しが良くなります。
        </p>
        <h3><code>continue</code>：処理をスキップして次のループへ</h3>
        <p>
          特定の条件を満たす行は処理の対象外にしたい場合などに、<code>continue</code> を使って処理をスキップすることができます。 <br>
          以下は、3列目が空欄の場合は何もしないで次の行に進む例です。
        </p>
        <pre><code class="language-javascript">for (let i = 0; i &lt; data.length; i++) {
  if (data[i][2] === "") continue;
  // 本処理
}</code></pre>
        <p>
          このように、条件によって処理を飛ばすことで、<strong>「不要な処理を避けて、本当に必要なデータだけに集中する」</strong>ことができます。<br>
          ネストを減らせるため、コード全体の見通しも良くなります。
        </p>
        <h3><code>return</code>：関数の実行を途中で終了</h3>
        <p>
          ループの途中で、もう処理を続ける必要がなくなった場合には <code>return</code> を使って<strong>関数全体の実行を止める</strong>ことができます。<br>
          以下は、スプレッドシートの中から「重要」というキーワードを含むデータを見つけたら、すぐに処理を終了する例です。
        </p>
        <pre><code class="language-javascript">function findKeyword() {
  for (let i = 0; i &lt; data.length; i++) {
    if (data[i][1].includes("重要")) {
      Logger.log("見つけた！");
      return;
    }
  }
}</code></pre>
        <p>
          このように <code>return</code> を使えば、<strong>「条件を満たした時点で無駄な処理をせずに抜ける」</strong>ことができ、効率的なスクリプトになります。<br>
          特に検索処理や条件マッチのチェックなどでは非常に有効です。
        </p>
      </section>

      <section id="indent" class="section">
        <h2>インデントの意味とコツ</h2>
        <p>
          コードを書くときに忘れてはいけないのが、<strong>見た目の整理（インデントや空白の使い方）</strong>です。<br>
          動けばいいと思いがちですが、見た目が整っていないコードは、後から見返すと何をしているのか非常に分かりにくく、バグの原因にもつながります。
        </p>
        <p>
          特に <strong>for文やif文などのネスト（入れ子）構造</strong>が増えると、見た目の乱れは処理の理解を大きく妨げます。<br>
          コードは「自分のために書くもの」であり、「未来の自分（あるいは他の人）」が読むものです。<br>
          だからこそ、処理の構造がひと目でわかるよう、<strong>一貫した見た目のルール</strong>を守ることがとても重要です。
        </p>
        <p>以下に、悪い例と良い例を比較してみましょう。</p>
        <h3>悪い例（インデントなし・読みにくい）</h3>
        <pre><code class="language-javascript">for (let i = 0; i &lt; list.length; i++) {
for (let j = 0; j &lt; list2.length; j++) {
if (list[i] === list2[j]) {
Logger.log("一致！");
}
}
}</code></pre>
        <p>
          一見すると動作には問題ありませんが、処理の階層構造がまったく見えず、どこからどこまでがループで、どの条件で何が行われているのかが非常に分かりにくい状態です。
        </p>
        <h4>良い例（インデントあり・構造が明確）</h4>
        <pre><code class="language-javascript">for (let i = 0; i &lt; list.length; i++) {
  for (let j = 0; j &lt; list2.length; j++) {
    if (list[i] === list2[j]) {
      Logger.log("一致！");
    }
  }
}</code></pre>
        <p>
          インデントを使って階層を表現することで、どの処理がどこに属しているのかが一目で分かります。 <br>
          読み手がコードを追いやすくなり、ミスにも気づきやすくなります。
        </p>
        <h3>なぜ「見た目」が大切なのか？</h3>
        <ul class="list-area">
          <li><strong>バグを防げる：</strong>ネストが深くなるほど、閉じ括弧 <code>}</code> の位置ミスが起きやすくなります。正しいインデントで書けば、構造ミスにすぐ気づけます。</li>
          <li><strong>読み返しやすい：</strong>数日後・数か月後の自分が見たときに、すぐに内容を理解できるようになります。</li>
          <li><strong>他人と共有しやすい：</strong>チームやネットにコードを載せるとき、読みやすいコードはそれだけで信頼されやすくなります。</li>
        </ul>
        <p>
          GASのようにすぐ動かせるスクリプトだからこそ、<strong>「とりあえず動いたコード」から「きれいで理解しやすいコード」</strong>への意識が大切です。<br>
          自分自身の作業効率を上げるためにも、書いたコードはできるだけ整理しておく習慣を身につけましょう。
        </p>
      </section>

      <section id="summary" class="section">
        <h2>まとめ</h2>
        <p>最初はただの「繰り返し」でも、</p>
        <ul>
          <li>データを走査する</li>
          <li>条件付きで処理する</li>
          <li>多重ループで複雑な処理に対応する</li>
        </ul>
        <p>といった具合に、使える場面が一気に広がります。</p>
        <p>
          GASでは「スプレッドシートとの連携」がほぼ必須なので、forの使いどころは本当に多いです。<br>
          慣れれば、仕事効率も思考整理も加速します。
        </p>
      </section>

      <section id="links" class="section">
        <h2>関連リンク</h2>

        <div class="page-links">
          <a href="/articles/blog/gas-if-guide/">
            <p class="p-link">if文とは？GAS初心者が実例で学んだ条件分岐の基本</p>
          </a>
        </div>
      </section>

      <p class="back-link">
        <a href="/articles/blog/index.html">← 記事一覧に戻る</a>
      </p>

      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6247585947417000" data-ad-slot="9719436679"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

      <section class="section">
        <p><a href="/">トップページへ戻る</a></p>
      </section>

    </article>
  </main>

  <div data-include="/includes/footer.html"></div>

  <script src="/assets/js/includes.js"></script>
  <script src="/assets/js/common.js"></script>

</body>

</html>
<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GASをスマホの操作で処理開始させるための工夫 | GASで作業をもっとラクに</title>
  <meta name="description"
    content="GAS（Google Apps Script）をスマホから実行する方法を紹介。図形ボタンが使えない環境でも、onEditトリガーと確認セルで安全に処理を始める実践例です。" />
  <meta property="og:title" content="GASをスマホで実行する工夫｜外出先でも使えるGoogle Apps Script活用法" />
  <meta property="og:description" content="GASをスマホから安全に実行するために、onEditトリガーと確認セルを使った工夫を紹介。図形ボタンやmsgBoxが使えない環境でも対応可能。" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="https://tree-tools-gas-guide.pages.dev/articles/blog/gas-mobile-trigger/" />
  <meta property="og:image" content="https://tree-tools-gas-guide.pages.dev/assets/images/tree-toos-icon.png">

  <link rel="stylesheet" href="/assets/css/style.css">
  <link rel="canonical" href="https://tree-tools-gas-guide.pages.dev/articles/blog/gas-mobile-trigger/" />

  <!-- 共通JS -->
  <script src="/assets/js/includes.js"></script>
  <script src="/assets/js/common.js"></script>
  <!-- Prism.js コード用 -->
  <script src="/assets/js/copy-code.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism-tomorrow.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-javascript.min.js"></script>
  <!-- favicon -->
  <link rel="icon" href="https://tree-tools-gas-guide.pages.dev/assets/images/tree-toos-icon.png" type="image/x-icon">
  <!-- 広告 -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6247585947417000"
    crossorigin="anonymous"></script>

<body>
  <!-- ヘッダー読込 -->
  <div data-include="/includes/header.html"></div>

  <main>
    <nav class="breadcrumb" aria-label="パンくずリスト">
      <ol>
        <li><a href="/">トップ</a></li>
        <li><a href="/articles/blog/">記事一覧</a></li>
        <li>記事</li>
      </ol>
    </nav>

    <article class="article-content">

      <h1 class="page-title">GASをスマホの操作で処理開始させるための工夫</h1>

      <div class="article-meta">
        <span class="date">投稿日：2025-07-17</span> |
        <span class="category">カテゴリ：技術</span> |
        <span class="tags">
          <span>GAS</span>
          <span>ツール</span>
          <span>業務効率化</span>
          <span>スマホ対応</span>
        </span>
      </div>

      <section class="section summary">
        <p>
          GASで作った処理をスマホからも安全に実行できるようにした実践記録です。<br>
          図形ボタンやmsgBoxが使えないスマホ環境で、onEditトリガーと確認セルを活用する工夫を紹介します。
        </p>
        <p>
          このブログは、Google Apps Script（GAS）を使った自作ツールの記録や、開発の過程での気づきをまとめたものです。<br>
          丁寧な解説というより、<strong>「こんなこともGASでできるんだ」</strong>というアイディアのきっかけになれば幸いです。
        </p>
      </section>

      <!-- 広告 -->
      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6247585947417000" data-ad-slot="9719436679"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      <nav class="section toc">
        <h2>目次</h2>
        <ul>
          <li><a href="#purpose">やりたかったこと</a></li>
          <li><a href="#logic">使ったロジック・ポイント</a></li>
          <li><a href="#code">コード例</a></li>
          <li><a href="#memo">メモ・反省・次回やりたいこと</a></li>
          <li><a href="#links">関連リンク</a></li>
        </ul>
      </nav>

      <section id="purpose" class="section">
        <h2>やりたかったこと</h2>
        <p>
          GASの処理はこれまでPCからしか実行できませんでした。<br>
          外出先や作業中でもスマホから処理できたら便利だと感じたのがきっかけです。<br>
          ただし、スマホでは図形ボタンやmsgBoxが使えないため、スマホ向けの安全な処理開始方法を模索しました。
        </p>
      </section>

      <section id="logic" class="section">
        <h2>使ったロジック・ポイント</h2>
        <p>スマホでも処理が開始できるよう、トリガーや確認手順を工夫しました。</p>

        <h3>① onEditトリガーの活用</h3>
        <ul class="list-area">
          <li>スプレッドシートの編集をトリガーにする</li>
          <li>スマホでも編集操作が可能なので汎用性が高い</li>
        </ul>

        <h3>② チェックボックスやプルダウンで処理の合図</h3>
        <ul class="list-area">
          <li>チェックボックスがONになったら処理を開始</li>
          <li>誤操作を避けるため、2段階チェックで実行</li>
        </ul>

        <h3>③ 確認メッセージをセルに表示</h3>
        <ul class="list-area">
          <li>msgBoxが使えないため、確認用メッセージはセルに出力</li>
          <li>5秒以内に確認チェックが入ったら処理開始</li>
          <li>終了メッセージもセルで通知</li>
        </ul>
      </section>

      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6247585947417000" data-ad-slot="9719436679"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      <section id="code" class="section">
        <h2>コード例</h2>
        <p>以下は、チェックボックスと確認セルを使ってスマホから処理を安全に始めるためのコードです。</p>

        <div class="code-container">
          <button class="copy-btn">Copy</button>
          <pre><code class="language-javascript">const SHEET_NAME = 'シート1';
const START_ROW = 2;
const START_COL = 2;

function onEdit(e) {
  const sheet = e.source.getSheetByName(SHEET_NAME);
  const range = e.range;
  const row = range.getRow();
  const col = range.getColumn();
  
  if (row === START_ROW && col === START_COL && e.value === "TRUE") {
    sheet.getRange("D2").setValue("本当に実行しますか？5秒以内に右のチェックをON");

    ScriptApp.newTrigger("checkConfirmation")
      .timeBased()
      .after(5000)
      .create();
  }
}

function checkConfirmation() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(SHEET_NAME);
  const confirmValue = sheet.getRange("E2").getValue();

  if (confirmValue === true) {
    sheet.getRange("D2").setValue("処理を開始します…");
    doSomething();
    sheet.getRange("D2").setValue("処理が完了しました");
  } else {
    sheet.getRange("D2").setValue("キャンセルされました（確認チェックなし）");
  }
}

function doSomething() {
  Logger.log("任意の処理中...");
}</code></pre>
        </div>
      </section>

      <section id="memo" class="section">
        <h2>メモ・反省・次回やりたいこと</h2>
        <p>
          スマホ対応をしたことで、PCを開かずに処理を実行できるようになり作業効率が上がりました。<br>
          ただし、スマホでは表示が崩れやすいため、PCとスマホでUIを分けた方が使いやすくなるかもしれません。<br>
          今後は、スマホ専用のインターフェースや、通知連携（LINEなど）にも挑戦したいです。
        </p>
      </section>

      <p class="back-link">
        <a href="/articles/blog/index.html">← 記事一覧に戻る</a>
      </p>

      <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6247585947417000" data-ad-slot="9719436679"
        data-ad-format="auto" data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>

      <section class="section">
        <p>
          <a href="/">トップページへ戻る</a>
        </p>
      </section>

    </article>
  </main>

  <div data-include="/includes/footer.html"></div>

</body>

</html>